{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///E:/TUGAS%20TUGAS/Kel7UTSFront%20%284%29/src/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3';\r\nimport path from 'path';\r\n\r\nconst dbPath = path.join(process.cwd(), 'hospital.db');\r\nconst db = new Database(dbPath);\r\n\r\n// Enable foreign keys\r\ndb.pragma('foreign_keys = ON');\r\n\r\n// Create tables\r\ndb.exec(`\r\n  CREATE TABLE IF NOT EXISTS patients (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    name TEXT NOT NULL,\r\n    date_of_birth TEXT,\r\n    gender TEXT,\r\n    address TEXT,\r\n    phone TEXT,\r\n    email TEXT,\r\n    medical_history TEXT,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS doctors (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    name TEXT NOT NULL,\r\n    specialty TEXT,\r\n    phone TEXT,\r\n    email TEXT,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS appointments (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    patient_id INTEGER,\r\n    doctor_id INTEGER,\r\n    date TEXT NOT NULL,\r\n    time TEXT NOT NULL,\r\n    reason TEXT,\r\n    status TEXT DEFAULT 'scheduled',\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY (patient_id) REFERENCES patients (id),\r\n    FOREIGN KEY (doctor_id) REFERENCES doctors (id)\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS rooms (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    room_number TEXT NOT NULL UNIQUE,\r\n    type TEXT,\r\n    status TEXT DEFAULT 'available',\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS lab_results (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    patient_id INTEGER,\r\n    test_name TEXT NOT NULL,\r\n    result TEXT,\r\n    date TEXT,\r\n    notes TEXT,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY (patient_id) REFERENCES patients (id)\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS medical_records (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    patient_id INTEGER,\r\n    doctor_id INTEGER,\r\n    diagnosis TEXT,\r\n    treatment TEXT,\r\n    date TEXT,\r\n    notes TEXT,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY (patient_id) REFERENCES patients (id),\r\n    FOREIGN KEY (doctor_id) REFERENCES doctors (id)\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS medicines (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    name TEXT NOT NULL,\r\n    generic_name TEXT,\r\n    category TEXT,\r\n    dosage_form TEXT,\r\n    strength TEXT,\r\n    manufacturer TEXT,\r\n    expiry_date TEXT,\r\n    stock_quantity INTEGER DEFAULT 0,\r\n    unit_price REAL,\r\n    min_stock_level INTEGER DEFAULT 10,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS prescriptions (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    patient_id INTEGER,\r\n    doctor_id INTEGER,\r\n    medicine_id INTEGER,\r\n    dosage TEXT,\r\n    frequency TEXT,\r\n    duration TEXT,\r\n    quantity INTEGER,\r\n    instructions TEXT,\r\n    status TEXT DEFAULT 'pending',\r\n    prescribed_date TEXT,\r\n    dispensed_date TEXT,\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY (patient_id) REFERENCES patients (id),\r\n    FOREIGN KEY (doctor_id) REFERENCES doctors (id),\r\n    FOREIGN KEY (medicine_id) REFERENCES medicines (id)\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS inventory (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    name TEXT NOT NULL,\r\n    category TEXT,\r\n    description TEXT,\r\n    quantity INTEGER DEFAULT 0,\r\n    unit TEXT,\r\n    location TEXT,\r\n    supplier TEXT,\r\n    purchase_date TEXT,\r\n    warranty_expiry TEXT,\r\n    maintenance_schedule TEXT,\r\n    status TEXT DEFAULT 'active',\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS payments (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    patient_id INTEGER,\r\n    amount REAL NOT NULL,\r\n    payment_type TEXT,\r\n    description TEXT,\r\n    payment_date TEXT,\r\n    status TEXT DEFAULT 'pending',\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    FOREIGN KEY (patient_id) REFERENCES patients (id)\r\n  );\r\n\r\n  CREATE TABLE IF NOT EXISTS users (\r\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n    username TEXT NOT NULL UNIQUE,\r\n    password TEXT NOT NULL,\r\n    role TEXT DEFAULT 'user',\r\n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\r\n  );\r\n`);\r\n\r\n// Insert sample data\r\nconst insertSampleData = () => {\r\n  // Sample patients\r\n  const patients = [\r\n    { name: 'John Doe', date_of_birth: '1980-01-01', gender: 'Male', address: '123 Main St', phone: '123-456-7890', email: 'john@example.com' },\r\n    { name: 'Jane Smith', date_of_birth: '1990-02-02', gender: 'Female', address: '456 Oak Ave', phone: '987-654-3210', email: 'jane@example.com' },\r\n  ];\r\n\r\n  // Sample doctors\r\n  const doctors = [\r\n    { name: 'Dr. Alice Johnson', specialty: 'Cardiology', phone: '111-222-3333', email: 'alice@hospital.com' },\r\n    { name: 'Dr. Bob Wilson', specialty: 'Neurology', phone: '444-555-6666', email: 'bob@hospital.com' },\r\n  ];\r\n\r\n  // Sample rooms\r\n  const rooms = [\r\n    { room_number: '101', type: 'General' },\r\n    { room_number: '102', type: 'ICU' },\r\n  ];\r\n\r\n  // Sample medicines\r\n  const medicines = [\r\n    { name: 'Paracetamol', generic_name: 'Acetaminophen', category: 'Pain Relief', dosage_form: 'Tablet', strength: '500mg', manufacturer: 'PharmaCorp', expiry_date: '2025-12-31', stock_quantity: 150, unit_price: 0.10, min_stock_level: 20 },\r\n    { name: 'Amoxicillin', generic_name: 'Amoxicillin', category: 'Antibiotic', dosage_form: 'Capsule', strength: '250mg', manufacturer: 'MediLab', expiry_date: '2024-10-15', stock_quantity: 80, unit_price: 0.25, min_stock_level: 15 },\r\n    { name: 'Ibuprofen', generic_name: 'Ibuprofen', category: 'Pain Relief', dosage_form: 'Tablet', strength: '200mg', manufacturer: 'HealthPharm', expiry_date: '2025-06-20', stock_quantity: 200, unit_price: 0.08, min_stock_level: 25 },\r\n  ];\r\n\r\n  // Sample inventory\r\n  const inventory = [\r\n    { name: 'Blood Pressure Monitor', category: 'Medical Equipment', description: 'Digital blood pressure monitor', quantity: 5, unit: 'pieces', location: 'Equipment Room A', supplier: 'MediTech', purchase_date: '2023-01-15', warranty_expiry: '2026-01-15', maintenance_schedule: 'Monthly', status: 'active' },\r\n    { name: 'Wheelchair', category: 'Mobility Aid', description: 'Standard wheelchair', quantity: 10, unit: 'pieces', location: 'Equipment Room B', supplier: 'MobilityCorp', purchase_date: '2023-03-10', warranty_expiry: '2025-03-10', maintenance_schedule: 'Quarterly', status: 'active' },\r\n    { name: 'Surgical Gloves', category: 'Consumables', description: 'Latex-free surgical gloves', quantity: 500, unit: 'boxes', location: 'Supply Room', supplier: 'SafeHands', purchase_date: '2023-05-01', warranty_expiry: null, maintenance_schedule: null, status: 'active' },\r\n  ];\r\n\r\n  // Sample payments\r\n  const payments = [\r\n    { patient_id: 1, amount: 150.00, payment_type: 'Cash', description: 'Consultation fee', payment_date: '2023-10-01', status: 'completed' },\r\n    { patient_id: 2, amount: 75.50, payment_type: 'Card', description: 'Lab test fee', payment_date: '2023-10-02', status: 'completed' },\r\n  ];\r\n\r\n  // Insert data\r\n  const insertPatient = db.prepare('INSERT OR IGNORE INTO patients (name, date_of_birth, gender, address, phone, email) VALUES (?, ?, ?, ?, ?, ?)');\r\n  const insertDoctor = db.prepare('INSERT OR IGNORE INTO doctors (name, specialty, phone, email) VALUES (?, ?, ?, ?)');\r\n  const insertRoom = db.prepare('INSERT OR IGNORE INTO rooms (room_number, type) VALUES (?, ?)');\r\n  const insertMedicine = db.prepare('INSERT OR IGNORE INTO medicines (name, generic_name, category, dosage_form, strength, manufacturer, expiry_date, stock_quantity, unit_price, min_stock_level) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)');\r\n  const insertInventory = db.prepare('INSERT OR IGNORE INTO inventory (name, category, description, quantity, unit, location, supplier, purchase_date, warranty_expiry, maintenance_schedule, status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)');\r\n  const insertPayment = db.prepare('INSERT OR IGNORE INTO payments (patient_id, amount, payment_type, description, payment_date, status) VALUES (?, ?, ?, ?, ?, ?)');\r\n\r\n  patients.forEach(p => insertPatient.run(p.name, p.date_of_birth, p.gender, p.address, p.phone, p.email));\r\n  doctors.forEach(d => insertDoctor.run(d.name, d.specialty, d.phone, d.email));\r\n  rooms.forEach(r => insertRoom.run(r.room_number, r.type));\r\n  medicines.forEach(m => insertMedicine.run(m.name, m.generic_name, m.category, m.dosage_form, m.strength, m.manufacturer, m.expiry_date, m.stock_quantity, m.unit_price, m.min_stock_level));\r\n  inventory.forEach(i => insertInventory.run(i.name, i.category, i.description, i.quantity, i.unit, i.location, i.supplier, i.purchase_date, i.warranty_expiry, i.maintenance_schedule, i.status));\r\n  payments.forEach(p => insertPayment.run(p.patient_id, p.amount, p.payment_type, p.description, p.payment_date, p.status));\r\n};\r\n\r\ninsertSampleData();\r\n\r\nexport default db;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 375, "column": 0}, "map": {"version":3,"sources":["file:///E:/TUGAS%20TUGAS/Kel7UTSFront%20%284%29/src/app/api/payments/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport db from '@/lib/db';\r\n\r\nexport async function GET() {\r\n  try {\r\n    const payments = db.prepare(`\r\n      SELECT p.*, pt.name as patient_name\r\n      FROM payments p\r\n      LEFT JOIN patients pt ON p.patient_id = pt.id\r\n      ORDER BY p.created_at DESC\r\n    `).all();\r\n    return NextResponse.json(payments);\r\n  } catch (error) {\r\n    return NextResponse.json({ error: 'Failed to fetch payments' }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { patient_id, amount, payment_type, description, payment_date, status } = await request.json();\r\n    const stmt = db.prepare(`\r\n      INSERT INTO payments (patient_id, amount, payment_type, description, payment_date, status)\r\n      VALUES (?, ?, ?, ?, ?, ?)\r\n    `);\r\n    const result = stmt.run(patient_id, amount, payment_type, description, payment_date, status);\r\n    return NextResponse.json({ id: result.lastInsertRowid, message: 'Payment created successfully' });\r\n  } catch (error) {\r\n    return NextResponse.json({ error: 'Failed to create payment' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,6HAAE,CAAC,OAAO,CAAC,CAAC;;;;;IAK7B,CAAC,EAAE,GAAG;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,YAAY,EAAE,WAAW,EAAE,YAAY,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QAClG,MAAM,OAAO,6HAAE,CAAC,OAAO,CAAC,CAAC;;;IAGzB,CAAC;QACD,MAAM,SAAS,KAAK,GAAG,CAAC,YAAY,QAAQ,cAAc,aAAa,cAAc;QACrF,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI,OAAO,eAAe;YAAE,SAAS;QAA+B;IACjG,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;AACF","debugId":null}}]
}